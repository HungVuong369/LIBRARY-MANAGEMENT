using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace HungVuong_C5_Assignment
{
    /// <summary>
    /// Interaction logic for ucStatisticalLibrarian.xaml
    /// </summary>
    public partial class ucStatisticalLibrarian : UserControl
    {
        public ucStatisticalLibrarian()
        {
            InitializeComponent();

            var quantityBorrowingBook = 0;
            if (DatabaseFirst.Instance.db.LoanSlips.Count() != 0)
                DatabaseFirst.Instance.db.LoanSlips.Sum(i => i.LoanDetails.Count);

            var statiBorrowedBookCount = new ucStatiRectangle(
                "M123.8,13.1L76.7,42.6l16.1,82.3l43.5-8.5l13.7,12.5c1.3,1.8,3.1,3.2,5.1,4c2.4,1,5.2,1.3,8,0.6l26.5-15.2 c1.7,5.5,10.1,41.2,10.2,45.9l-28.7-26c-4.4-4.4-11.1-5.5-16.7-2.7c-5.6,2.8-8.6,8.9-7.6,15.1l13.3,75.9c1.4,9,7,15.6,17,14.1 c8.4-1.3,12.5-9.8,11.1-19.5l-7.8-37.5l26.7,28c3.5,3.5,8.8,5.9,15.1,5c8-1.2,13.4-11.1,15-15.8c0.5-1.4,9.5-27.7,4.6-61.8 c-4.2-29.1-19.2-43.7-21.6-45.9c-4.4-4.1-10-9.7-22.9-5.3L162.6,106l-5.1-4.9l-14.1-71.5l-17,3.3L123.8,13.1z M87.2,49.7l49.1-9.6 l10.4,52.7l-3.9-3c-5.5-4.2-13.3-3.2-17.5,2.3c-4,5.2-3.2,12.5,1.6,16.9l-27,5.3L87.2,49.7z M179.3,82.8 c-10.6-4.5-15.5-16.7-11.1-27.3s16.7-15.5,27.3-11.1c10.6,4.5,15.5,16.7,11.1,27.3S189.9,87.3,179.3,82.8z M34,175.4h106.4v12.8H34 V175.4z M13.5,193.2h106.4v20H13.5V193.2z M14.7,153.6h79.4v14.9H14.7V153.6z M34,219.4h106.4v20H34V219.4z",
                quantityBorrowingBook.ToString(),
                "Borrowed Books",
                "#1ABC9C",
                "#1ABC9C"
            );
            var statiBookCount = new ucStatiRectangle(
                "M7.8125 3C7.335938 3.089844 6.992188 3.511719 7 4L7 31L3 31C2.96875 31 2.9375 31 2.90625 31C2.390625 31.046875 1.996094 31.480469 2 32L2 36C2 36.550781 2.449219 37 3 37L6 37L6 44.5C6 45.867188 7.132813 47 8.5 47C9.867188 47 11 45.867188 11 44.5L11 37L39 37L39 44.5C39 45.867188 40.132813 47 41.5 47C42.867188 47 44 45.867188 44 44.5L44 37L47 37C47.550781 37 48 36.550781 48 36L48 32C48 31.449219 47.550781 31 47 31L43.875 31C43.902344 30.867188 43.902344 30.726563 43.875 30.59375L38.8125 9.1875C38.703125 8.671875 38.210938 8.328125 37.6875 8.40625C37.667969 8.414063 37.644531 8.425781 37.625 8.4375L32.75 9.59375C32.378906 9.679688 32.085938 9.972656 32 10.34375L32 10C32 9.449219 31.550781 9 31 9L25 9L25 4C25 3.449219 24.550781 3 24 3L16.0625 3C16.042969 3 16.019531 3 16 3L8 3C7.96875 3 7.9375 3 7.90625 3C7.875 3 7.84375 3 7.8125 3 Z M 9 5L15 5L15 31L9 31 Z M 17 5L23 5L23 9.90625C23 9.9375 23 9.96875 23 10L23 31L17 31 Z M 10.71875 7C10.167969 7.078125 9.78125 7.589844 9.859375 8.140625C9.9375 8.691406 10.449219 9.078125 11 9L13 9C13.359375 9.003906 13.695313 8.816406 13.878906 8.503906C14.058594 8.191406 14.058594 7.808594 13.878906 7.496094C13.695313 7.183594 13.359375 6.996094 13 7L11 7C10.96875 7 10.9375 7 10.90625 7C10.875 7 10.84375 7 10.8125 7C10.78125 7 10.75 7 10.71875 7 Z M 18.71875 7C18.167969 7.078125 17.78125 7.589844 17.859375 8.140625C17.9375 8.691406 18.449219 9.078125 19 9L21 9C21.359375 9.003906 21.695313 8.816406 21.878906 8.503906C22.058594 8.191406 22.058594 7.808594 21.878906 7.496094C21.695313 7.183594 21.359375 6.996094 21 7L19 7C18.96875 7 18.9375 7 18.90625 7C18.875 7 18.84375 7 18.8125 7C18.78125 7 18.75 7 18.71875 7 Z M 37.09375 10.59375L37.71875 13.28125C37.507813 12.902344 37.082031 12.703125 36.65625 12.78125C36.625 12.789063 36.59375 12.800781 36.5625 12.8125L35.59375 13.03125C35.1875 13.101563 34.867188 13.410156 34.78125 13.8125L34.1875 11.28125 Z M 32 10.78125L36.78125 31L32 31 Z M 25 11L30 11L30 31L25 31 Z M 26.71875 13C26.167969 13.078125 25.78125 13.589844 25.859375 14.140625C25.9375 14.691406 26.449219 15.078125 27 15L28 15C28.359375 15.003906 28.695313 14.816406 28.878906 14.503906C29.058594 14.191406 29.058594 13.808594 28.878906 13.496094C28.695313 13.183594 28.359375 12.996094 28 13L27 13C26.96875 13 26.9375 13 26.90625 13C26.875 13 26.84375 13 26.8125 13C26.78125 13 26.75 13 26.71875 13 Z M 37.84375 13.84375L40.875 26.6875C40.652344 26.445313 40.324219 26.332031 40 26.375C39.945313 26.382813 39.894531 26.390625 39.84375 26.40625C39.824219 26.414063 39.800781 26.425781 39.78125 26.4375L38.8125 26.65625C38.40625 26.726563 38.085938 27.035156 38 27.4375L35 14.6875C35.265625 14.984375 35.683594 15.09375 36.0625 14.96875L37.03125 14.75C37.476563 14.664063 37.808594 14.292969 37.84375 13.84375 Z M 10.71875 27C10.167969 27.078125 9.78125 27.589844 9.859375 28.140625C9.9375 28.691406 10.449219 29.078125 11 29L13 29C13.359375 29.003906 13.695313 28.816406 13.878906 28.503906C14.058594 28.191406 14.058594 27.808594 13.878906 27.496094C13.695313 27.183594 13.359375 26.996094 13 27L11 27C10.96875 27 10.9375 27 10.90625 27C10.875 27 10.84375 27 10.8125 27C10.78125 27 10.75 27 10.71875 27 Z M 18.71875 27C18.167969 27.078125 17.78125 27.589844 17.859375 28.140625C17.9375 28.691406 18.449219 29.078125 19 29L21 29C21.359375 29.003906 21.695313 28.816406 21.878906 28.503906C22.058594 28.191406 22.058594 27.808594 21.878906 27.496094C21.695313 27.183594 21.359375 26.996094 21 27L19 27C18.96875 27 18.9375 27 18.90625 27C18.875 27 18.84375 27 18.8125 27C18.78125 27 18.75 27 18.71875 27 Z M 26.71875 27C26.167969 27.078125 25.78125 27.589844 25.859375 28.140625C25.9375 28.691406 26.449219 29.078125 27 29L28 29C28.359375 29.003906 28.695313 28.816406 28.878906 28.503906C29.058594 28.191406 29.058594 27.808594 28.878906 27.496094C28.695313 27.183594 28.359375 26.996094 28 27L27 27C26.96875 27 26.9375 27 26.90625 27C26.875 27 26.84375 27 26.8125 27C26.78125 27 26.75 27 26.71875 27 Z M 41.09375 27.625L41.6875 30.0625L38.78125 30.75L38.21875 28.3125C38.484375 28.609375 38.902344 28.71875 39.28125 28.59375L40.25 28.375C40.65625 28.320313 40.992188 28.023438 41.09375 27.625 Z M 4 33L46 33L46 35L4 35 Z M 8 37L9 37L9 44.5C9 44.785156 8.785156 45 8.5 45C8.214844 45 8 44.785156 8 44.5 Z M 41 37L42 37L42 44.5C42 44.785156 41.785156 45 41.5 45C41.214844 45 41 44.785156 41 44.5Z",
                 (DatabaseFirst.Instance.db.Books.Where(i => i.IdBookStatus != "BS2").Count() - quantityBorrowingBook).ToString(),
                "Reserve Books",
                "#2ECC71",
                "#2ecc71"
            );

            var statiLoanCount = new ucStatiRectangle(
                "M462.792,392.533h-31.858v-35.2c0-4.717-6.096-7.467-10.808-7.467h-34.133c-4.713,0-6.258,2.75-6.258,7.467v35.2h-36.408 c-4.713,0-6.258,2.75-6.258,7.467v34.133c0,4.717,1.546,9.6,6.258,9.6h36.408V476.8c0,4.717,1.546,9.6,6.258,9.6h34.133 c4.713,0,10.808-4.883,10.808-9.6v-33.067h31.858c4.713,0,10.808-4.883,10.808-9.6V400 C473.6,395.283,467.504,392.533,462.792,392.533z M456.533,426.667h-36.408c-4.713,0-6.258,2.75-6.258,7.467v35.2H396.8v-35.2 c0-4.717-6.096-7.467-10.808-7.467h-31.858V409.6h31.858c4.713,0,10.808-4.883,10.808-9.6v-33.067h17.067V400 c0,4.717,1.546,9.6,6.258,9.6h36.408V426.667z M406.358,0H65.108C50.971,0,38.4,10.4,38.4,24.5v460.867c0,14.1,12.542,26.633,26.65,26.633h257.158 c4.712,0,8.533-3.817,8.533-8.533s-3.821-8.533-8.533-8.533H65.05c-4.696,0-9.583-4.883-9.583-9.567V24.5 c0-4.683,4.912-7.433,9.642-7.433h341.25c4.65,0,7.508,2.808,7.508,7.4V323.2c0,4.717,3.821,8.533,8.533,8.533 s8.533-3.817,8.533-8.533V24.467C430.933,10.392,420.496,0,406.358,0z M278.4,59.733h-85.333c-4.713,0-8.533,3.817-8.533,8.533c0,4.717,3.821,8.533,8.533,8.533H278.4 c4.713,0,8.533-3.817,8.533-8.533C286.933,63.55,283.113,59.733,278.4,59.733z M355.2,119.467H116.267c-4.713,0-8.533,3.817-8.533,8.533c0,4.717,3.821,8.533,8.533,8.533H355.2 c4.713,0,8.533-3.817,8.533-8.533C363.733,123.283,359.913,119.467,355.2,119.467z M355.2,179.2H116.267c-4.713,0-8.533,3.817-8.533,8.533c0,4.717,3.821,8.533,8.533,8.533H355.2 c4.713,0,8.533-3.817,8.533-8.533C363.733,183.017,359.913,179.2,355.2,179.2z M355.2,238.933H116.267c-4.713,0-8.533,3.817-8.533,8.533c0,4.717,3.821,8.533,8.533,8.533H355.2 c4.713,0,8.533-3.817,8.533-8.533C363.733,242.75,359.913,238.933,355.2,238.933z M355.2,298.667H116.267c-4.713,0-9.6,2.75-9.6,7.467v128c0,4.717,4.887,9.6,9.6,9.6H304c4.713,0,8.533-3.817,8.533-8.533 s-3.821-8.533-8.533-8.533H123.733V315.733H345.6v50.133c0,4.717,3.821,8.533,8.533,8.533s8.533-3.817,8.533-8.533v-59.733 C362.667,301.417,359.913,298.667,355.2,298.667z",
                DatabaseFirst.Instance.db.LoanSlips.Count().ToString(),
                "Loan Slip",
                "#3498DB",
                "#3498DB"
            );

            var statiReturnCount = new ucStatiRectangle(
                "M10,22v2c0,7.72,6.28,14,14,14s14-6.28,14-14s-6.28-14-14-14h-4V4l-8,8l8,8v-6h4c5.514,0,10,4.486,10,10s-4.486,10-10,10 s-10-4.486-10-10v-2H10z",
                DatabaseFirst.Instance.db.LoanHistories.Count().ToString(),
                "Loan History",
                "#007BFF",
                "#007BFF"
            );

            var statiLoanOverdueCount = new ucStatiRectangle(
                "M12.144 1.157a8 8 0 10-.709 14.068 1 1 0 00-.858-1.806 6 6 0 112.86-7.955 1 1 0 001.814-.845 8 8 0 00-3.107-3.462z M7 5a1 1 0 112 0v4a1 1 0 01-.553.894l-2 1a1 1 0 11-.894-1.788L7 8.382V5zm9 10a1 1 0 11-2 0 1 1 0 012 0zm-1-7a1 1 0 00-1 1v3a1 1 0 102 0V9a1 1 0 00-1-1z",
                DatabaseFirst.Instance.db.LoanSlips.Where(i => DbFunctions.TruncateTime(DateTime.Now) > DbFunctions.TruncateTime(i.ExpDate)).Count().ToString(),
                "Expire Loan Slip",

                "#34495E",
                "#34495E"
            );

            var statiISBNMostBorrowed = new ucStatiRectangle(
               "M512,216.906c-0.031-29.313-23.781-53.078-53.094-53.094h-75.891c-3.531,0-43.578,0-47.219,0 c-6.953,0.063-13.328,1.094-17.969,1.031c-1.859,0-3.328-0.156-4.188-0.344L313,164.313l-0.156-0.469 c-0.141-0.609-0.281-1.625-0.281-3.094c0-0.906,0.141-2.188,0.25-3.438l30.281-74.875c2.906-7.188,4.281-14.656,4.281-21.969 c0.031-23.188-13.844-45.156-36.656-54.406c-7.156-2.891-14.641-4.281-21.984-4.281c-23.203-0.016-45.141,13.875-54.391,36.672 l-0.047,0.078l-51.359,129.313h0.031c-3.438,8.063-6.203,15.625-8.906,22.156c-4.078,10.031-8.063,17.25-12.766,21.438 c-2.359,2.125-4.922,3.719-8.484,4.969c-3.531,1.219-8.172,2.047-14.391,2.047c-3.781-0.016-7.375,0.422-10.891,1.078H44.5 c-24.594,0-44.5,19.922-44.5,44.5v201.703c0,24.578,19.906,44.484,44.5,44.484h61.578c13.641,0,24.719-11.063,24.719-24.719 v-20.484c4.328,2.531,8.891,4.828,13.797,6.672c17.156,6.5,37.531,9.219,62.063,9.219h191.25c29.313,0,53.094-23.719,53.094-53.047 c0-6.891-1.406-13.453-3.828-19.453c21.156-7,36.453-26.875,36.453-50.375c0.016-9.594-2.688-18.547-7.141-26.25 c6.422-5.25,10.781-12.156,13.266-19.375c2.719-7.75,3.656-15.906,3.656-24.203c0-5.141-1.094-10.141-2.969-15.016 c-1.375-3.469-3.172-6.891-5.375-10.125C501.125,253.938,511.984,236.703,512,216.906z M458.938,243.797h-8.844 c-3.469,0-6.813,1.391-9.25,3.828s-3.844,5.813-3.844,9.25s1.406,6.813,3.844,9.25s5.781,3.844,9.25,3.844 c2.516,0,4.578,0.563,6.594,1.609c2.969,1.516,5.797,4.375,7.75,7.719c1.969,3.281,2.875,7.047,2.813,8.906 c0.031,8.297-1.438,15.078-3.719,19.078c-1.156,2.031-2.391,3.453-3.906,4.594c-1.531,1.125-3.438,2.063-6.344,2.688 c-4.938,1-8.813,4.734-10.031,9.625c-1.234,4.906,0.438,10.031,4.344,13.25c6.094,5.094,9.875,12.313,9.875,20.594 c-0.031,14.844-12.047,26.875-26.922,26.906h-6.234c-5.438,0-10.313,3.344-12.219,8.438c-1.938,5.094-0.531,10.813,3.563,14.438 c5.688,5.078,9.172,12.063,9.172,20.047c-0.016,14.844-12.047,26.859-26.922,26.891h-191.25 c-20.063,0.016-36.031-2.063-48.313-5.969c-9.25-2.938-16.391-6.828-22.172-11.688c-1.938-1.656-3.703-3.469-5.375-5.359V245.5 c2.109-0.531,4.547-0.875,7.625-0.875c11.328,0,21.156-2.047,29.453-6.25c6.188-3.109,11.375-7.406,15.5-12.172 c6.188-7.203,10.219-15.297,13.719-23.484c3.5-8.219,6.5-16.625,10.031-24.906l0.156-0.313l51.328-129.281 c5.109-12.625,17.281-20.266,30.125-20.281c4.047,0,8.172,0.766,12.172,2.391c12.656,5.094,20.297,17.266,20.313,30.141 c0,4.047-0.75,8.156-2.375,12.172l-31,76.672c-0.422,1.016-0.688,2.047-0.844,3.125c-0.391,2.906-0.594,5.656-0.594,8.313 c0,4.875,0.688,9.484,2.484,13.781c1.313,3.219,3.297,6.203,5.734,8.563c3.656,3.594,8.078,5.594,12.031,6.625 c4,1.063,7.719,1.281,11.172,1.297c7.422-0.047,14.109-1.094,17.969-1.031c3.641,0,43.688,0,47.219,0h75.891 c14.844-0.016,26.938,12.047,26.938,26.922C485.813,231.75,473.781,243.781,458.938,243.797z",
               GetMostBorrowedISBN(),
               "Most Borrowed ISBN",
               "#F39C12",
               "#F39C12"
            );

            var statiDamagedBook = new ucStatiRectangle(
               "M122.586,149.125h79.448c5.297,0,8.828-3.531,8.828-8.828c0-5.297-3.531-8.828-8.828-8.828h-79.448 c-5.297,0-8.828,3.531-8.828,8.828C113.759,145.594,117.29,149.125,122.586,149.125z M87.276,193.263h114.759c5.297,0,8.828-3.531,8.828-8.828c0-5.297-3.531-8.828-8.828-8.828H87.276 c-5.297,0-8.828,3.531-8.828,8.828C78.448,189.732,81.979,193.263,87.276,193.263z M87.276,237.401h79.448c5.297,0,8.828-3.531,8.828-8.828c0-5.297-3.531-8.828-8.828-8.828H87.276 c-5.297,0-8.828,3.531-8.828,8.828C78.448,233.87,81.979,237.401,87.276,237.401z M202.034,263.884h-79.448c-5.297,0-8.828,3.531-8.828,8.828c0,5.297,3.531,8.828,8.828,8.828h79.448 c5.297,0,8.828-3.531,8.828-8.828C210.862,267.415,207.331,263.884,202.034,263.884z M87.276,325.677h114.759c5.297,0,8.828-3.531,8.828-8.828s-3.531-8.828-8.828-8.828H87.276 c-5.297,0-8.828,3.531-8.828,8.828S81.979,325.677,87.276,325.677z M307.966,193.263h52.966c5.297,0,8.828-3.531,8.828-8.828c0-5.297-3.531-8.828-8.828-8.828h-52.966 c-5.297,0-8.828,3.531-8.828,8.828C299.138,189.732,302.669,193.263,307.966,193.263z M307.966,149.125h61.793c5.297,0,8.828-3.531,8.828-8.828c0-5.297-3.531-8.828-8.828-8.828h-61.793 c-5.297,0-8.828,3.531-8.828,8.828C299.138,145.594,302.669,149.125,307.966,149.125z M360.931,308.021h-17.655c-5.297,0-8.828,3.531-8.828,8.828s3.531,8.828,8.828,8.828h17.655 c5.297,0,8.828-3.531,8.828-8.828S366.228,308.021,360.931,308.021z M307.966,281.539h52.966c5.297,0,8.828-3.531,8.828-8.828c0-5.297-3.531-8.828-8.828-8.828h-52.966 c-5.297,0-8.828,3.531-8.828,8.828C299.138,278.008,302.669,281.539,307.966,281.539z M307.966,237.401h70.621c5.297,0,8.828-3.531,8.828-8.828c0-5.297-3.531-8.828-8.828-8.828h-70.621 c-5.297,0-8.828,3.531-8.828,8.828C299.138,233.87,302.669,237.401,307.966,237.401z M502.172,69.677h-84.745l-12.359-12.359c-1.766-1.766-3.531-2.648-5.297-2.648c-48.504-6.063-98.704-1.07-144.77,14.963 c-67.406-23.769-146.534-23.483-213.63,0.044H34.31H7.828C2.531,69.677-1,73.208-1,78.504V422.78v26.483 c0,5.297,3.531,8.828,8.828,8.828h494.345c5.297,0,8.828-3.531,8.828-8.828V422.78V78.504 C511,73.208,507.469,69.677,502.172,69.677z M493.345,87.332v326.621h-210.16c43.75-13.728,83.671-18.853,119.236-15.89 c2.648,0,5.297-0.883,7.062-2.648l19.421-19.421c3.531-3.531,3.531-8.828,0-12.359l-29.131-29.131l29.131-29.131 c3.531-3.531,3.531-8.828,0-12.359l-29.131-29.131l29.131-29.131c3.531-3.531,3.531-8.828,0-12.359l-29.131-29.131l29.131-29.131 c3.531-3.531,3.531-8.828,0-12.359l-29.131-29.131l29.131-29.131c1.766-1.766,2.648-3.531,2.648-6.179H493.345z M51.992,410.827 c0.397-0.161,0.799-0.31,1.197-0.468c1.324-0.526,2.651-1.042,3.985-1.538c0.83-0.308,1.665-0.601,2.5-0.897 c0.831-0.297,1.662-0.593,2.498-0.878c1.305-0.443,2.616-0.873,3.933-1.289c0.271-0.086,0.541-0.173,0.812-0.258 c47.599-14.799,102.348-11.591,162.485,8.455H43.138c0.883,0,2.648,0,3.531-0.883C48.433,412.295,50.208,411.549,51.992,410.827z M395.359,72.325l15.007,15.007l-29.131,28.248c-3.531,3.531-3.531,8.828,0,12.359l29.131,29.131l-29.131,29.131 c-3.531,3.531-3.531,8.828,0,12.359l29.131,29.131l-29.131,29.131c-3.531,3.531-3.531,8.828,0,12.359l29.131,29.131 l-29.131,29.131c-3.531,3.531-3.531,8.828,0,12.359l29.131,29.131l-9.71,9.71c-41.49-2.648-87.393,4.414-136.828,22.069V84.683 C305.317,71.442,351.221,67.028,395.359,72.325z M246.172,84.683v316.028c-3.095-1.054-6.164-2.061-9.22-3.045 c-70.021-23.909-133.516-25.794-188.58-4.362c-1.752,0.679-3.497,1.382-5.235,2.11V87.332c0.883,0,1.766,0,2.648-0.883 C108.462,64.38,182.614,63.497,246.172,84.683z M16.655,87.332h8.828v317.793c0,5.297,3.531,8.828,8.828,8.828H16.655V87.332z M493.345,440.435H16.655v-8.828h476.69V440.435z",
               DatabaseFirst.Instance.db.BookStatus.FirstOrDefault(i => i.Id == "BS3").Books.Count.ToString(),
               "Damaged Book",
               "#9B59B6",
               "#9B59B6"
            );

            var statiLostBook = new ucStatiRectangle(
              "M 25,27L 46,19L 46,22.25L 28.5,29L 31.75,31.25L 51,23.75L 51,48.5L 31.75,57L 25,52L 25,27 Z M 41.8929,46.0327C 40.9009,46.4197 40.0967,47.5376 40.0967,48.5296C 40.0967,49.5216 40.9009,50.0121 41.8929,49.6251C 42.8849,49.2381 43.6891,48.1202 43.6891,47.1282C 43.6891,46.1361 42.8849,45.6457 41.8929,46.0327 Z M 42.2521,31.5228C 39.0777,32.7612 36.5042,36.1777 36.5042,39.1538L 36.5042,39.8723L 40.0967,38.4708L 40.0967,37.3931C 40.0967,36.2027 41.0617,34.8612 42.2521,34.3968C 43.4425,33.9324 44.4076,34.5209 44.4076,35.7113C 44.4076,36.2305 44.4076,36.4298 42.9706,38.4274C 42.2521,39.4262 40.0967,41.7753 40.0967,44.2187L 40.0967,45.2964L 43.6891,43.895L 43.6891,42.458C 43.6891,41.2676 44.4076,40.0223 45.8445,38.7432C 47.2815,37.4641 48,35.3876 48,34.3099C 48,31.3338 45.4266,30.2844 42.2521,31.5228 Z ",
              DatabaseFirst.Instance.db.BookStatus.FirstOrDefault(i => i.Id == "BS2").Books.Count.ToString(),
              "Lost Book",
              "#E74C3C",
              "#E74C3C"
           );

            var statiReturnBook = new ucStatiRectangle(
              "M 25,27L 46,19L 46,22.25L 28.5,29L 31.75,31.25L 51,23.75L 51,48.5L 31.75,57L 25,52L 25,27 Z M 41.8929,46.0327C 40.9009,46.4197 40.0967,47.5376 40.0967,48.5296C 40.0967,49.5216 40.9009,50.0121 41.8929,49.6251C 42.8849,49.2381 43.6891,48.1202 43.6891,47.1282C 43.6891,46.1361 42.8849,45.6457 41.8929,46.0327 Z M 42.2521,31.5228C 39.0777,32.7612 36.5042,36.1777 36.5042,39.1538L 36.5042,39.8723L 40.0967,38.4708L 40.0967,37.3931C 40.0967,36.2027 41.0617,34.8612 42.2521,34.3968C 43.4425,33.9324 44.4076,34.5209 44.4076,35.7113C 44.4076,36.2305 44.4076,36.4298 42.9706,38.4274C 42.2521,39.4262 40.0967,41.7753 40.0967,44.2187L 40.0967,45.2964L 43.6891,43.895L 43.6891,42.458C 43.6891,41.2676 44.4076,40.0223 45.8445,38.7432C 47.2815,37.4641 48,35.3876 48,34.3099C 48,31.3338 45.4266,30.2844 42.2521,31.5228 Z ",
              DatabaseFirst.Instance.db.BookStatus.FirstOrDefault(i => i.Id == "BS2").Books.Count.ToString(),
              "Lost Book",
              "#E74C3C",
              "#E74C3C"
           );

            var statiAdult = new ucStatiRectangle(
              "M605.096,480 c-135.542-2.098-239.082-111.058-239.999-240C367.336,105.667,477.133,0.942,605.096,0c135.662,5.13,239.036,108.97,240.001,240 C842.429,374.439,733.19,479.09,605.096,480z M799.139,529.788c170.592,1.991,257.094,151.63,257.881,301.269V1200H889.784 l0.001-324.254c-4.072-22.416-19.255-30.018-33.164-27.82c-13.022,2.059-24.929,12.701-25.56,27.82V1200h-464.67V875.746 c-3.557-21.334-17.128-29.537-30.331-28.709c-14.138,0.889-27.853,12.135-28.393,28.709V1200h-164.68V831.057 c-0.98-159.475,99.901-300.087,259.137-301.269H799.139L799.139,529.788z",
              DatabaseFirst.Instance.db.Adults.Where(i => i.Status).Count().ToString(),
              "Adults",
              "#000000",
              "#000000"
           );

            var statiChildren = new ucStatiRectangle(
              "M10 5c0 1.105-0.895 2-2 2s-2-0.895-2-2c0-1.105 0.895-2 2-2s2 0.895 2 2z M12.79 10.32l-2.6-2.63c-0.421-0.426-1.004-0.69-1.65-0.69h-1.070c-0 0-0 0-0.001 0-0.648 0-1.235 0.264-1.659 0.69l-2.6 2.63c-0.216 0.129-0.358 0.362-0.358 0.628 0 0.403 0.327 0.73 0.73 0.73 0.266 0 0.499-0.142 0.626-0.355l1.792-1.793v6.47h1.5v-4h1v4h1.5v-6.47l1.75 1.8c0.135 0.175 0.344 0.287 0.58 0.287 0.403 0 0.73-0.327 0.73-0.73 0-0.228-0.105-0.432-0.269-0.566z",
              DatabaseFirst.Instance.db.Children.Where(i => i.Status).Count().ToString(),
              "Children",
              "#FF7B00",
              "#FF7B00"
           );

            wpContainer.Children.Add(statiBorrowedBookCount);
            wpContainer.Children.Add(statiBookCount);
            wpContainer.Children.Add(statiLoanCount);
            wpContainer.Children.Add(statiReturnCount);
            wpContainer.Children.Add(statiLoanOverdueCount);
            wpContainer.Children.Add(statiISBNMostBorrowed);
            wpContainer.Children.Add(statiDamagedBook);
            wpContainer.Children.Add(statiLostBook);
            wpContainer.Children.Add(statiAdult);
            wpContainer.Children.Add(statiChildren);
        }

        private string GetMostBorrowedISBN()
        {
            Dictionary<string, int> isbn = new Dictionary<string, int>();

            foreach (var item in DatabaseFirst.Instance.db.LoanDetails)
            {
                if (isbn.Keys.Contains(item.Book.ISBN))
                {
                    isbn[item.Book.ISBN]++;
                }
                else
                {
                    isbn.Add(item.Book.ISBN, 1);
                }
            }

            foreach (var item in DatabaseFirst.Instance.db.LoanDetailHistories)
            {
                if (isbn.Keys.Contains(item.Book.ISBN))
                {
                    isbn[item.Book.ISBN]++;
                }
                else
                {
                    isbn.Add(item.Book.ISBN, 1);
                }
            }
            return isbn.OrderByDescending(i => i.Value).FirstOrDefault().Key;
        }
    }
}
